---
title: "GuÃ­a de GrÃ¡ficos para el AnÃ¡lisis Exploratorio de Datos (EDA)"
author: "Enrique DÃ­az Ocampo"
date: "`r Sys.Date()`"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
```


# 1ï¸âƒ£ IntroducciÃ³n

Esta guÃ­a proporciona una serie de grÃ¡ficos para realizar un AnÃ¡lisis Exploratorio de Datos (EDA) en el dataset IMDb Movies.

Exploraremos los siguientes aspectos:

- AnÃ¡lisis Unidimensional: DistribuciÃ³n de una sola variable.

- AnÃ¡lisis Multivariado: RelaciÃ³n entre dos o mÃ¡s variables.

- VisualizaciÃ³n con ggplot2 para identificar patrones en los datos.

Estos grÃ¡ficos nos ayudarÃ¡n a entender la distribuciÃ³n de presupuestos, ingresos, gÃ©neros, puntuaciones y otros factores clave de las pelÃ­culas.

# 2ï¸âƒ£ Carga de LibrerÃ­as y ConfiguraciÃ³n
```{r}
install.packages("here", dependencies = TRUE)
library(here)           # Manejo de rutas dinÃ¡micas
source(here("reportes/Proy_Imdb/00_CONFIGURACION.r"))
```

```{r}
# ğŸ“Œ Cargar librerÃ­as necesarias
library(janitor)        # Limpieza de nombres de columnas
library(summarytools)   # Resumen estadÃ­stico detallado
library(ggplot2)        # GrÃ¡ficos
library(dplyr)          # ManipulaciÃ³n de datos
library(plotly)         # GrÃ¡ficos Interactivos
library(htmlwidgets)
library(here)
# ğŸ“Œ ConfiguraciÃ³n de grÃ¡ficos globales
theme_set(theme_minimal())

# ğŸ“Œ Cargar scripts de preprocesamiento y anÃ¡lisis
source(here("scripts/utils.r"))
source(here("scripts/1_preprocesamiento_esp_dataset.r"))
source(here("scripts/2_analisis_grÃ¡fico.r"))
```


# 3ï¸âƒ£ Carga y Preprocesamiento de Datos

ğŸ“Œ Â¿QuÃ© hace esta funciÃ³n?

âœ” Limpia los nombres de las columnas.

âœ” Convierte variables categÃ³ricas en factores.

âœ” Filtra valores invÃ¡lidos.

âœ” Retorna un dataset listo para anÃ¡lisis.

```{r}
# ğŸ“Œ Cargar y preprocesar el dataset
Imdb_data <- preprocesar_datos(here("datasets/imdb_data_limpio.csv"), "Imdb")
```

# 4ï¸âƒ£ AnÃ¡lisis Unidimensional

El anÃ¡lisis unidimensional permite estudiar la distribuciÃ³n de una sola variable.

## ğŸ“Œ Boxplot para una variable cuantitativa (Presupuesto)

```{r}
filtered_genres <- Imdb_data %>%
  group_by(genre) %>%
  filter(n() > 50) %>%
  ungroup()

p_boxplot_budget <- crear_boxplot(
  data = filtered_genres,
  y = "budget_x",
  title = "DistribuciÃ³n de Presupuestos en IMDb",
  xlab = "PelÃ­culas",
  ylab = "Presupuesto (USD)",
  fill = NULL,
  colores = "blue"
) +
  scale_y_log10()  # Aplicar escala logarÃ­tmica al eje Y

# Guardar y mostrar el grÃ¡fico
guardar_grafico(p_boxplot_budget, here("reportes/Proy_Imdb/resultados_generados/boxplot_budget.png"))
convertir_interactivo(p_boxplot_budget)


```


## ğŸ“Œ Histograma para una variable cuantitativa (PuntuaciÃ³n de PelÃ­culas)

```{r}
filtered_genres <-  Imdb_data %>%
  group_by(genre) %>%
  filter(n() > 50) %>%
  ungroup()

p_histograma_score <- crear_histograma(
  data = filtered_genres,
  x = "score",
  title = "DistribuciÃ³n de Puntuaciones de PelÃ­culas en IMDb",
  xlab = "PuntuaciÃ³n IMDb",
  ylab = "Frecuencia",
  binwidth = 1,
  colores = "lightblue",
  densidad = TRUE
)

# Guardar el grÃ¡fico
guardar_grafico(p_histograma_score, here("reportes/Proy_Imdb/resultados_generados/histograma_score.png"))

# Convertir a grÃ¡fico interactivo
convertir_interactivo(p_histograma_score)



```

# 5ï¸âƒ£ AnÃ¡lisis de GÃ©neros de PelÃ­culas

ğŸ“Œ Barplot de Frecuencia de GÃ©neros

```{r}
# Filtrar gÃ©neros con mÃ¡s de 50 pelÃ­culas
filtered_genres <-  Imdb_data %>%
  group_by(genre) %>%
  filter(n() > 50) %>%
  ungroup()

# Crear el grÃ¡fico de barras solo con los gÃ©neros filtrados
p_barplot_genre <- crear_barplot(
  data = filtered_genres,
  x = "genre",
  fill = "genre",
  title = "DistribuciÃ³n de GÃ©neros de PelÃ­culas",
  xlab = "GÃ©nero",
  ylab = "Frecuencia",
  dodge = FALSE,
  voltear = TRUE,
  legend_position = "none"
)

# Guardar el grÃ¡fico
guardar_grafico(p_barplot_genre, here("reportes/Proy_Imdb/resultados_generados/barplot_genre_filtered.png"))

# Convertir a grÃ¡fico interactivo
convertir_interactivo(p_barplot_genre)


```




# 6ï¸âƒ£ AnÃ¡lisis Multivariado

ğŸ“Œ RelaciÃ³n entre Presupuesto y RecaudaciÃ³n de PelÃ­culas


```{r}
# Filtrar gÃ©neros con mÃ¡s de 50 pelÃ­culas
filtered_genres <- Imdb_data %>%
  group_by(genre) %>%
  filter(n() > 50) %>%
  ungroup()

# Filtrar valores de presupuesto y recaudaciÃ³n para que sean positivos
filtered_movies <- filtered_genres %>%
  filter(budget_x > 0, revenue > 0)  # âœ… Eliminar valores cero o negativos

# Crear el grÃ¡fico de dispersiÃ³n con escala logarÃ­tmica
p_scatter_budget_revenue <- crear_scatterplot(
  data = filtered_movies,
  x = "budget_x",
  y = "revenue",
  title = "RelaciÃ³n entre Presupuesto y RecaudaciÃ³n de PelÃ­culas",
  xlab = "Presupuesto (USD)",
  ylab = "RecaudaciÃ³n (USD)",
  color = NULL,
  colores = "steelblue"
) +
  scale_x_log10() +  # âœ… Aplicar escala logarÃ­tmica solo despuÃ©s de filtrar
  scale_y_log10() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 16, face = "bold"),
    axis.text = element_text(size = 12),
    axis.title = element_text(size = 14, face = "bold")
  )

# Guardar el grÃ¡fico
guardar_grafico(p_scatter_budget_revenue, here("reportes/Proy_Imdb/resultados_generados/scatter_budget_revenue.png"))

# Convertir a grÃ¡fico interactivo
convertir_interactivo(p_scatter_budget_revenue )



```

## ğŸ“Œ Boxplot de Puntuaciones por GÃ©nero

```{r}
# Filtrar gÃ©neros con mÃ¡s de 50 pelÃ­culas
filtered_genres <-  Imdb_data %>%
  group_by(genre) %>%
  filter(n() > 50) %>%
  ungroup()


p_boxplot_score_genre <- crear_boxplot(
  data = filtered_genres,
  x = "genre",
  y = "score",
  fill = "genre",
  title = "DistribuciÃ³n de Puntuaciones por GÃ©nero en IMDb",
  xlab = "GÃ©nero",
  ylab = "PuntuaciÃ³n IMDb",
  fill_lab = "GÃ©nero",
  colores = NULL,
  rotar_x = TRUE
) +
  theme(axis.text.x = element_text(angle = 90, hjust = 1, size = 10), legend.position = "none")

# Guardar el grÃ¡fico
guardar_grafico(p_boxplot_score_genre, here("reportes/Proy_Imdb/resultados_generados/boxplot_score_genre.png"))

# Convertir a grÃ¡fico interactivo
convertir_interactivo(p_boxplot_score_genre)

```























